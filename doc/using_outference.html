<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Shuxiao Chen" />

<meta name="date" content="2019-07-01" />

<title>Using Outference Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using Outference Package</h1>
<h4 class="author"><em>Shuxiao Chen</em></h4>
<h4 class="date"><em>2019-07-01</em></h4>



<p>This vignette illustrates the usage of <code>outference</code> package, which is a tool for doing valid statistical inference corrected for outlier removal in linear regressions. We refer the reader to <a href="https://arxiv.org/abs/1711.10635" class="uri">https://arxiv.org/abs/1711.10635</a> for technical details.</p>
<div id="the-main-function" class="section level2">
<h2>The Main Function</h2>
<p>The main function in this package is <code>outference</code>, which is written in a similar fashion as the <code>lm</code> function and returns an object of S3 class <code>outference</code>. This function detects outliers using a user-specified method, and fits a linear regression model with outliers removed. Common generic functions for the <code>lm</code> object are overwritten to extract useful inferential results from the <code>outference</code> object.</p>
</div>
<div id="a-synthetic-example" class="section level2">
<h2>A Synthetic Example</h2>
<p>We now illustrate the package using a synthetic example.</p>
<div id="generating-the-data" class="section level3">
<h3>Generating the Data</h3>
<p>We generate the data from a “mean-shift model”. That is, we first generate responses from a classical linear model, and then shift several responses, who are considered as outliers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2667</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>; p &lt;-<span class="st"> </span><span class="dv">6</span>
<span class="co"># generate the design matrix</span>
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>(p<span class="op">-</span><span class="dv">1</span>)), n, (p<span class="op">-</span><span class="dv">1</span>))
X &lt;-<span class="st"> </span><span class="kw">scale</span>(X, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>)) <span class="co"># col of X and has norm sqrt(n)</span>
my.data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(X)
X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">1</span>, n), X)
<span class="co"># generate the response with noise i.i.d. from N(0, 1)</span>
beta &lt;-<span class="st"> </span><span class="kw">rnorm</span>(p)
y &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)
<span class="co"># assume the first five observations are outliers, shifed upwards by 5 units</span>
y[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span>y[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">+</span><span class="st"> </span><span class="dv">5</span>
<span class="co"># format the dataset</span>
my.data &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">y =</span> y, my.data)
<span class="kw">head</span>(my.data)</code></pre></div>
<pre><code>##           y         V1         V2         V3         V4         V5
## 1  7.622590  0.8337472 -1.5311918 -0.2753330  2.1008698  0.6430451
## 2  5.466536 -0.7806253  0.6859779 -0.1302192  0.3139285 -1.0493696
## 3  8.006647  0.5070534 -0.8544950 -0.1311867  0.1338000 -0.5532070
## 4  6.268534 -0.9316292 -0.1427418 -2.1363311  1.4994160 -0.2626911
## 5  7.907222 -0.8442128 -2.5002488  0.8771076 -0.1563199  0.3121189
## 6 -2.933560 -0.5168133  0.7143922  0.5540261  0.4419245  1.2691914</code></pre>
</div>
<div id="fitting-the-model" class="section level3">
<h3>Fitting the Model</h3>
<p>We then detect the outliers in the synthetic data. For illustration purposes, we use the classical Cook’s distance, and claim an observation is an outlier if its cook’s distance is greater than <span class="math inline">\(4/n\)</span>. Our method accommodates both cases when the noise level <span class="math inline">\(\sigma\)</span> is known or unknown. In the <span class="math inline">\(\sigma\)</span> known case, our method is the generalization of classical <span class="math inline">\(z\)</span>-test (testing the regression coefficients) and <span class="math inline">\(\chi^2\)</span>-test (tesing for group structures or “nested models”), as well as the classical <span class="math inline">\(z\)</span>-intervals (for regression coefficients). When <span class="math inline">\(\sigma\)</span> is unknown, we can either plug in an estimate of <span class="math inline">\(\sigma\)</span>, or we resort to the generalization of classical <span class="math inline">\(t\)</span>-test (testing the regression coefficients) and <span class="math inline">\(F\)</span>-test (tesing for group structures or “nested models”). For now our method does not provide the corresponding generalization of <span class="math inline">\(t\)</span>-intervals. In this example, we will focus on the case where <span class="math inline">\(\sigma\)</span> is estimated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(outference)
fit &lt;-<span class="st"> </span><span class="kw">outference</span>(y <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> my.data, <span class="dt">method =</span> <span class="st">&quot;cook&quot;</span>, <span class="dt">cutoff =</span> <span class="dv">4</span>, <span class="dt">sigma =</span> <span class="st">&quot;estimate&quot;</span>)
fit</code></pre></div>
<pre><code>## 
## Call:
## outference(formula = y ~ ., data = my.data, method = &quot;cook&quot;, 
##     cutoff = 4, sigma = &quot;estimate&quot;)
## 
## Outlier detection method: cook with cutoff = 4
## Outlier detected: 1 2 3 4 5 42
## 
## Coefficients:
## (Intercept)           V1           V2           V3           V4  
##      0.3885       0.3704      -1.0095       0.0320       0.4271  
##          V5  
##     -0.9530</code></pre>
<p>Notice that the syntax and the output are very similar to those of the <code>lm</code> function.</p>
</div>
<div id="extracting-the-information" class="section level3">
<h3>Extracting the Information</h3>
<p>To visualize how the outliers are detected, we can plot the Cook’s distance for each observation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We see that the first five observations are successfully detected, while the 42-nd observation is a false alarm. As usual, we can use the <code>coef</code> function to extract the regression coefficients in the model with detected outliers removed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(fit)</code></pre></div>
<pre><code>## (Intercept)          V1          V2          V3          V4          V5 
##   0.3884858   0.3703673  -1.0095435   0.0319968   0.4271390  -0.9530430</code></pre>
<p>To test the significance of regression coefficients and to test for the “global null” (i.e. test if the model only consists of the intercept), we use the <code>summary</code> function. Again notice the similarity of the output with that of <code>summary.lm</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fit)</code></pre></div>
<pre><code>## 
## Call:
## outference(formula = y ~ ., data = my.data, method = &quot;cook&quot;, 
##     cutoff = 4, sigma = &quot;estimate&quot;)
## 
## Outlier detection method: cook with cutoff = 4
## Outlier detected: 1 2 3 4 5 42
## 
##      Min       1Q   Median       3Q      Max 
## -2.46881 -0.49668 -0.09320  0.59531  2.35085 
## 
##             Estimate Std. Error z value Corrected p-value    
## (Intercept)   0.3885     0.1378   2.819           0.85154    
## V1            0.3704     0.1363   2.717           0.84872    
## V2           -1.0095     0.1402  -7.202          9.86e-09 ***
## V3            0.0320     0.1358   0.236           0.63643    
## V4            0.4271     0.1359   3.143           0.00663 ** 
## V5           -0.9530     0.1326  -7.187          6.43e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.033 on 88 degrees of freedom
## Multiple R-squared:  0.6673    Adjusted R-squared:  0.6484
## Chisq-statistic: 113.7 on 5 DF,  Corrected p-value: &lt; 2.2e-16</code></pre>
<p>One calls the <code>confint</code> function to extract the confidence intervals for each coefficient.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(fit, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) -1.3971064  0.6118180
## V1          -1.3316566  0.5933818
## V2          -2.3461034 -0.7620057
## V3          -0.2288750  0.6239357
## V4           0.1345695  0.6934683
## V5          -2.0299869 -0.7161546</code></pre>
<p>One uses the <code>predict</code> function to extract confidence intervals for the regression surfaces, as well as the prediction intervals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># new data points for prediction</span>
new.data &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">rnorm</span>(p<span class="op">-</span><span class="dv">1</span>))
<span class="kw">colnames</span>(new.data) &lt;-<span class="st"> </span><span class="kw">colnames</span>(my.data)[<span class="op">-</span><span class="dv">1</span>]
new.data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(new.data)
<span class="kw">predict</span>(fit, <span class="dt">newdata =</span> new.data, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##         fit         lwr       upr
## 1 0.5468063 0.000161274 0.9674844</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(fit, <span class="dt">newdata =</span> new.data, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##         fit       lwr     upr
## 1 0.5468063 -2.866368 3.76021</code></pre>
</div>
<div id="other-exported-functions" class="section level3">
<h3>Other Exported Functions</h3>
<p>Apart from the <code>outference</code> function, there are two other functions that are also exported: <code>coeftest</code> and <code>grptest</code>. Those two functions are internally called by the <code>summary</code> function, and they correspond to testing for regression coefficients and testing the group structures. The aim for exporting those two questions is to allow more flexibility for experienced users (since users can access to more information from the output of those two functions).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coeftest</span>(fit, <span class="dt">index =</span> <span class="dv">2</span>) <span class="co"># test the significance of &quot;V1&quot;</span></code></pre></div>
<pre><code>## $Z
## [1] 2.716798
## 
## $se
## [1] 0.1363249
## 
## $truncation
## Object of class Intervals
## 1 interval over R:
## (2.4197038337713, 7.47066506214985)
## 
## $pval
## [1] 0.8487244</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grptest</span>(fit, <span class="dt">group =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>) <span class="co"># test if &quot;V1&quot; and &quot;V2&quot; are simultaneously zero</span></code></pre></div>
<pre><code>## $statistic
## [1] 62.85566
## 
## $df
## [1] 2
## 
## $truncation
## Object of class Intervals
## 1 interval over R:
## (23.1606141995307, 79.5591070896091)
## 
## $pval
## [1] 2.400093e-09</code></pre>
</div>
</div>
<div id="a-real-data-example" class="section level2">
<h2>A Real Data Example</h2>
<p>We now illustrate the package by analyzing a real data example. This example reproduces some of the results given in <a href="https://arxiv.org/pdf/1711.10635.pdf" class="uri">https://arxiv.org/pdf/1711.10635.pdf</a>. We consider the Brownlee’s Stack Loss Plant Data, which involves measures on an industrial plant’s operation and has <span class="math inline">\(21\)</span> observations and three covariates. In fact, this dataset is readily available in R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;stackloss&quot;</span>)
<span class="kw">head</span>(stackloss)</code></pre></div>
<pre><code>##   Air.Flow Water.Temp Acid.Conc. stack.loss
## 1       80         27         89         42
## 2       80         27         88         37
## 3       75         25         90         37
## 4       62         24         87         28
## 5       62         22         87         18
## 6       62         23         87         18</code></pre>
<p>Interested readers can run <code>?stackloss</code> for detailed information on this dataset. <code>Air.Flow</code> is the rate of operation of the plant, <code>Water.Temp</code> is the temperature of cooling water circulated through coils in the absorption tower, and <code>Acid.Conc</code> is the concentration of the acid circulating, minus 50, times 10. The response, <code>stack.loss</code> is an inverse measure of the overall efficiency of the plant. This data set is considered by many papers in the outlier detection literature. The general consensus is that observations <span class="math inline">\(1, 3, 4\)</span> and <span class="math inline">\(21\)</span> are outliers.</p>
<p>We now run the <code>outfernce</code> command, using Cook’s distance to help us to identify outliers. We use the cutoff of <span class="math inline">\(4\)</span>. That is, any observations whose Cook’s distance is greater than <span class="math inline">\(4/n\)</span>, with <span class="math inline">\(n\)</span> being the number of observations, are considered as outliers. For this example, we do not specify <code>sigma = &quot;estimate&quot;</code>, so that we are actually doing selective <span class="math inline">\(t\)</span>-tests and selective <span class="math inline">\(F\)</span>-tests.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(outference)
stack.fit &lt;-<span class="st"> </span><span class="kw">outference</span>(stack.loss <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> stackloss, <span class="dt">method =</span> <span class="st">&quot;cook&quot;</span>, <span class="dt">cutoff =</span> <span class="dv">4</span>)</code></pre></div>
<p>We first plot each observation’s Cook’s distance as well as our cutoff value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(stack.fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show which observations are considered as outliers</span>
stack.fit<span class="op">$</span>outlier.det</code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>We see that observation 21 is detected with the current cutoff value. We remove this observation and proceed to statistical inference.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(stack.fit)</code></pre></div>
<pre><code>## 
## Call:
## outference(formula = stack.loss ~ ., data = stackloss, method = &quot;cook&quot;, 
##     cutoff = 4)
## 
## Outlier detection method: cook with cutoff = 4
## Outlier detected: 21
## 
##     Min      1Q  Median      3Q     Max 
## -3.0449 -2.0578  0.1025  1.0709  6.3017 
## 
##             Estimate Std. Error t value Corrected p-value   
## (Intercept) -43.7040     9.4916  -4.605           0.00109 **
## Air.Flow      0.8891     0.1188   7.481           0.00403 **
## Water.Temp    0.8166     0.3250   2.512           0.02309 * 
## Acid.Conc.   -0.1071     0.1245  -0.860           0.40234   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.569 on 16 degrees of freedom
## Multiple R-squared:  0.9488    Adjusted R-squared:  0.9392
## F-statistic: 98.82 on 3 and 16 DF,  Corrected p-value: 0.0006375</code></pre>
<p>Notice that the output of the <code>summary</code> closely matches with those produced by native <code>lm</code> functionalities. As a comparison, we print the summary for the original full model (i.e., without removing any outliers), as well as the model whose outliers are removed (but the inference is not corrected!):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># full model</span>
<span class="kw">summary</span>(stack.fit<span class="op">$</span>fit.full)</code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = stack.loss ~ ., data = stackloss)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.2377 -1.7117 -0.4551  2.3614  5.6978 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -39.9197    11.8960  -3.356  0.00375 ** 
## Air.Flow      0.7156     0.1349   5.307  5.8e-05 ***
## Water.Temp    1.2953     0.3680   3.520  0.00263 ** 
## Acid.Conc.   -0.1521     0.1563  -0.973  0.34405    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.243 on 17 degrees of freedom
## Multiple R-squared:  0.9136, Adjusted R-squared:  0.8983 
## F-statistic:  59.9 on 3 and 17 DF,  p-value: 3.016e-09</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># model with outliers removed, but inference is not corrected</span>
<span class="kw">summary</span>(stack.fit<span class="op">$</span>fit.rm)</code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = stack.loss ~ ., data = stackloss, subset = -21L)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.0449 -2.0578  0.1025  1.0709  6.3017 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -43.7040     9.4916  -4.605 0.000293 ***
## Air.Flow      0.8891     0.1188   7.481 1.31e-06 ***
## Water.Temp    0.8166     0.3250   2.512 0.023088 *  
## Acid.Conc.   -0.1071     0.1245  -0.860 0.402338    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.569 on 16 degrees of freedom
## Multiple R-squared:  0.9488, Adjusted R-squared:  0.9392 
## F-statistic: 98.82 on 3 and 16 DF,  p-value: 1.541e-10</code></pre>
<p>Comparing the above results, we can see that removing the 21st observation increases the goodness-of-fit of the linear model (adjusted R-squared goes from <span class="math inline">\(0.8983\)</span> to <span class="math inline">\(0.9392\)</span>). And the corrected <span class="math inline">\(p\)</span>-values may (or may not) be different from the naive, uncorrected ones.</p>
<p>We now construct confidence intervals for each regression coefficient (this may take a while due to computational burdens):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(stack.fit, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##                    2.5 %      97.5 %
## (Intercept) -67.47672911 -19.9313328
## Air.Flow      0.55353835   1.1867523
## Water.Temp    0.00261688   1.7378157
## Acid.Conc.   -0.41907023   0.2047875</code></pre>
<p>We can compare the corrected CIs with the naive, uncorrected ones (remember that <code>fit.rm</code> is the model whose outliers are removed, but the inference is not corrected):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(stack.fit<span class="op">$</span>fit.rm, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##                   2.5 %      97.5 %
## (Intercept) -63.8252504 -23.5828115
## Air.Flow      0.6371624   1.1410539
## Water.Temp    0.1275882   1.5056515
## Acid.Conc.   -0.3711573   0.1568746</code></pre>
<p>We can also form CIs for regression surfaces, as well as prediction intervals, using the <code>predict</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># say we want to predict with the first observation </span>
newdata =<span class="st"> </span>stackloss[<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]
<span class="co"># CI for regression surface (a.k.a., short prediction intervals)</span>
<span class="kw">predict</span>(stack.fit, <span class="dt">newdata =</span> newdata, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 39.93778 36.28951 43.57586</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># prediction intervals (a.k.a., wide prediction intervals) </span>
<span class="kw">predict</span>(stack.fit, <span class="dt">newdata =</span> newdata, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 39.93778 28.42806 51.41557</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># predict with the whole dataset is also possible by running the following command, </span>
<span class="co"># but it may take a while</span>

<span class="co"># predict(stack.fit, interval = &quot;confidence&quot;, level = 0.95)</span></code></pre></div>
<p>We now investigate the other two outlier detection methods considered in our paper. We first consider using a Lasso regression to detect outliers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stack.lasso =<span class="st"> </span><span class="kw">outference</span>(stack.loss <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> stackloss, <span class="dt">method =</span> <span class="st">&quot;lasso&quot;</span>)
<span class="kw">plot</span>(stack.lasso)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stack.lasso<span class="op">$</span>outlier.det</code></pre></div>
<pre><code>## [1]  4 21</code></pre>
<p>Now we detect two outliers. We proceed to the inference.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(stack.lasso)</code></pre></div>
<pre><code>## 
## Call:
## outference(formula = stack.loss ~ ., data = stackloss, method = &quot;lasso&quot;)
## 
## Outlier detection method: lasso with cutoff = 0.230381
## Outlier detected: 4 21
## 
##     Min      1Q  Median      3Q     Max 
## -3.1114 -1.4080 -0.0749  1.0946  3.6074 
## 
##              Estimate Std. Error t value Corrected p-value  
## (Intercept) -42.45308    7.38458  -5.749            0.0752 .
## Air.Flow      0.95660    0.09447  10.126            0.0796 .
## Water.Temp    0.55557    0.26403   2.104            0.0526 .
## Acid.Conc.   -0.10877    0.09678  -1.124            0.2787  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.996 on 15 degrees of freedom
## Multiple R-squared:  0.9693    Adjusted R-squared:  0.9632
## F-statistic: 158.1 on 3 and 15 DF,  Corrected p-value: 0.08217</code></pre>
<p>We then consider using DFFITS to detect outliers. We expect the results to be similar to the one produced by using Cook’s distance, since DFFITS is approximately a constant multiple of Cook’s distance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stack.dffits =<span class="st"> </span><span class="kw">outference</span>(stack.loss <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> stackloss, <span class="dt">method =</span> <span class="st">&quot;dffits&quot;</span>)
<span class="kw">plot</span>(stack.dffits)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stack.dffits<span class="op">$</span>outlier.det</code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>We proceed to the inference.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(stack.dffits)</code></pre></div>
<pre><code>## 
## Call:
## outference(formula = stack.loss ~ ., data = stackloss, method = &quot;dffits&quot;)
## 
## Outlier detection method: dffits with cutoff = 4
## Outlier detected: 21
## 
##     Min      1Q  Median      3Q     Max 
## -3.0449 -2.0578  0.1025  1.0709  6.3017 
## 
##             Estimate Std. Error t value Corrected p-value   
## (Intercept) -43.7040     9.4916  -4.605           0.00446 **
## Air.Flow      0.8891     0.1188   7.481           0.01193 * 
## Water.Temp    0.8166     0.3250   2.512           0.02309 * 
## Acid.Conc.   -0.1071     0.1245  -0.860           0.40234   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.569 on 16 degrees of freedom
## Multiple R-squared:  0.9488    Adjusted R-squared:  0.9392
## F-statistic: 98.82 on 3 and 16 DF,  Corrected p-value: 0.003135</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
